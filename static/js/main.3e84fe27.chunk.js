(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{220:function(e,t,n){},235:function(e,t,n){},238:function(e,t,n){},240:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),o=n(22),r=n.n(o),s=(n(87),n(75)),c=n(3),d=n(4),l=n(6),u=n(5),h=n(7),m=n(1),p=(n(89),n(91),n(9)),b=n.n(p),f=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={itemName:"",touched:!1},n.handleNameChange=n.handleNameChange.bind(Object(m.a)(Object(m.a)(n))),n.onSubmit=n.onSubmit.bind(Object(m.a)(Object(m.a)(n))),n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.validate();return i.a.createElement("form",{onSubmit:this.onSubmit},i.a.createElement("input",{value:this.state.itemName,type:"text",onChange:this.handleNameChange,className:"form__field "+(e&&this.state.touched?"form__field--error":""),autoComplete:"off",placeholder:"\u041d\u043e\u0432\u0430\u044f \u0442\u043e\u0447\u043a\u0430 \u043c\u0430\u0440\u0448\u0440\u0443\u0442\u0430"}))}},{key:"validate",value:function(){return""===this.state.itemName}},{key:"onSubmit",value:function(e){e.preventDefault(),this.validate()?this.setTouched(!0):(this.props.onSubmit(this.state.itemName),this.resetForm())}},{key:"handleNameChange",value:function(e){var t=e.target.value;this.setState(function(){return{itemName:t}})}},{key:"setTouched",value:function(e){this.setState(b()(this.state,{touched:{$set:e}}))}},{key:"resetForm",value:function(){this.setState(b()(this.state,{itemName:{$set:""},touched:{$set:!1}}))}}]),t}(a.Component),v=(n(93),n(13)),g=n(50),O=n.n(g),j=n(77),y=n.n(j),k=(n(220),n(14)),P=n.n(k),C=n(33),w={beginDrag:function(e,t,n){var a=Object(o.findDOMNode)(n).offsetWidth;return{id:e.item.id,index:e.index,name:e.item.name,width:a}}},E={hover:function(e,t,n){var a=t.getItem().index,i=e.index;if(a!==i){var r=Object(o.findDOMNode)(n).getBoundingClientRect(),s=(r.bottom-r.top)/2,c=t.getClientOffset().y-r.top;a<i&&c<s||a>i&&c>s||(e.moveItem(a,i),t.getItem().index=i)}}},I=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).handleRemove=n.handleRemove.bind(Object(m.a)(Object(m.a)(n))),n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.props,t=e.item,n=e.isDragging,a=e.connectDragSource,o=e.connectDropTarget,r=n?0:1;return a&&o&&a(o(i.a.createElement("li",{className:"list-item",style:{opacity:r}},i.a.createElement("div",{className:"list-item__content"},t.name),i.a.createElement("button",{className:"list-item__delete-button",onClick:this.handleRemove},i.a.createElement(P.a,{icon:C.ic_close})))))}},{key:"handleRemove",value:function(){this.props.removeItem(this.props.index)}}]),t}(a.Component),S=Object(v.DropTarget)("listItem",E,function(e){return{connectDropTarget:e.dropTarget()}})(Object(v.DragSource)("listItem",w,function(e,t){return{connectDragSource:e.dragSource(),isDragging:t.isDragging()}})(I)),M=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"list-item",style:this.props.style},i.a.createElement("div",{className:"list-item__content"},this.props.name),i.a.createElement("button",{className:"list-item__delete-button"},i.a.createElement(P.a,{icon:C.ic_close})))}}]),t}(a.Component),_=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"list"},i.a.createElement("ul",{className:"list__list"},this.props.items.map(function(t,n){return i.a.createElement(S,{key:t.id,index:n,item:t,moveItem:e.props.moveItem,removeItem:e.props.removeItem})})),i.a.createElement(g.Preview,{generator:this.generatePreview}))}},{key:"generatePreview",value:function(e,t,n){return Object.assign(n,{width:"".concat(t.width,"px")}),i.a.createElement(M,{name:t.name,style:n})}}]),t}(a.Component),N=Object(v.DragDropContext)(O()(y.a))(_),x=n(78),D=n.n(x),$=function(){function e(t,n){Object(c.a)(this,e),this.id=n.id,this.marker=new t.maps.Marker({position:new t.maps.LatLng(n.coord.lat,n.coord.lng),title:n.name,draggable:!0})}return Object(d.a)(e,[{key:"setEventHandler",value:function(e,t){var n=this;this.marker.addListener(e,function(){t(n)})}},{key:"getPosition",value:function(){return this.marker.getPosition()}},{key:"setMap",value:function(e){this.marker.setMap(e)}}]),e}(),L=(n(235),function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).map=null,n.route=null,n.infowindow=null,n.mapPoints=[],n.handleMapChange=n.handleMapChange.bind(Object(m.a)(Object(m.a)(n))),n.handlePointInfo=n.handlePointInfo.bind(Object(m.a)(Object(m.a)(n))),n.handlePointMove=n.handlePointMove.bind(Object(m.a)(Object(m.a)(n))),n.handlePointHasMoved=n.handlePointHasMoved.bind(Object(m.a)(Object(m.a)(n))),n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this.props.google;!e.google&&t&&(this.initMap(),this.initRoute(),this.initInfowindow(),this.map.addListener("center_changed",this.handleMapChange)),e.points!==this.props.points&&this.updateRoute(e.points,this.props.points)}},{key:"render",value:function(){return i.a.createElement("div",{ref:"map",className:"map"},this.props.warning?i.a.createElement("div",{className:"map__warning"},i.a.createElement("span",null,"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a. \u041d\u0435 \u0443\u0434\u0430\u0435\u0442\u0441\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u043a\u0430\u0440\u0442\u0443.")):"")}},{key:"initMap",value:function(){var e=this.props.google;this.map=new e.maps.Map(this.refs.map,{zoom:12,center:new e.maps.LatLng(this.props.center.lat,this.props.center.lng),mapTypeControl:!1,streetViewControl:!1})}},{key:"initRoute",value:function(){this.route=new this.props.google.maps.Polyline({geodesic:!1,strokeColor:"#FF0000",strokeOpacity:1,strokeWeight:2}),this.route.setMap(this.map)}},{key:"initInfowindow",value:function(){this.infowindow=new this.props.google.maps.InfoWindow({})}},{key:"handleMapChange",value:function(){this.props.handleMapChange(this.transformCoordinates(this.map.getCenter()))}},{key:"updateRoute",value:function(e,t){var n=this;e.forEach(function(e){t.find(function(t){return t.id===e.id})||n.deletePoint(e.id)}),t.forEach(function(t,a){e.findIndex(function(e){return e.id===t.id})<0&&n.addPoint(t,a)}),this.mapPoints.forEach(function(e,t){var a=e.id;if(a!==n.props.points[t].id){var i=n.mapPoints.findIndex(function(e){return a===e.id}),o=n.props.points.findIndex(function(e){return a===e.id});n.reorderPoint(i,o)}})}},{key:"addPoint",value:function(e,t){var n=new $(this.props.google,e);n.setEventHandler("click",this.handlePointInfo),n.setEventHandler("drag",this.handlePointMove),n.setEventHandler("dragend",this.handlePointHasMoved),n.setMap(this.map),this.mapPoints.splice(t,0,n),this.route.getPath().insertAt(t,n.getPosition())}},{key:"deletePoint",value:function(e){var t=this.mapPoints.findIndex(function(t){return t.id===e});this.mapPoints[t].setMap(null),this.mapPoints.splice(t,1),this.route.getPath().removeAt(t)}},{key:"reorderPoint",value:function(e,t){this.mapPoints.splice(t,0,this.mapPoints.splice(e,1)[0]);var n=this.route.getPath(),a=n.getAt(e);n.removeAt(e),n.insertAt(t,a)}},{key:"handlePointInfo",value:function(e){var t=e.marker;this.infowindow.setContent('<div class="map__infowindow">'.concat(t.title,"</div>")),this.infowindow.open(this.map,t)}},{key:"handlePointMove",value:function(e){this.route.getPath().setAt(this.getPointIndexById(e.id),e.getPosition())}},{key:"handlePointHasMoved",value:function(e){this.props.handlePointMove(this.getPointIndexById(e.id),this.transformCoordinates(e.getPosition()))}},{key:"getPointIndexById",value:function(e){return this.mapPoints.findIndex(function(t){return t.id===e})}},{key:"transformCoordinates",value:function(e){return{lat:e.lat(),lng:e.lng()}}}]),t}(a.Component)),A="https://maps.googleapis.com/maps/api/js?key=".concat("AIzaSyCQfJgnHnO6LlY_DxE-VaYEB_qWV-W9O7c"),H=D()(A,{globalName:"google"})(L),R=n(79),W=(n(238),n(81)),B=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return i.a.createElement("button",{className:"toggle-button",onClick:this.props.handleClick},i.a.createElement(P.a,{icon:W.ic_keyboard_arrow_right,size:"24"}))}}]),t}(a.Component),T=window.matchMedia("(min-width: 768px)"),Q=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={scriptError:!1,points:[],currentCoord:{lat:55.7526443,lng:37.62370929999997},currentId:0,sidebarOpen:!0,sidebarDocked:T.matches},n.toggleSidebar=n.toggleSidebar.bind(Object(m.a)(Object(m.a)(n))),n.toggleSidebar=n.toggleSidebar.bind(Object(m.a)(Object(m.a)(n))),n.handleMediaQueryChanged=n.handleMediaQueryChanged.bind(Object(m.a)(Object(m.a)(n))),n.addPoint=n.addPoint.bind(Object(m.a)(Object(m.a)(n))),n.removePoint=n.removePoint.bind(Object(m.a)(Object(m.a)(n))),n.reorderPoints=n.reorderPoints.bind(Object(m.a)(Object(m.a)(n))),n.updateCurrentCoord=n.updateCurrentCoord.bind(Object(m.a)(Object(m.a)(n))),n.movePoint=n.movePoint.bind(Object(m.a)(Object(m.a)(n))),n.callAfterScriptLoads=n.callAfterScriptLoads.bind(Object(m.a)(Object(m.a)(n))),n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentWillMount",value:function(){T.addListener(this.handleMediaQueryChanged)}},{key:"render",value:function(){var e=i.a.createElement("div",null,i.a.createElement("div",{className:"app__sidebar-top"},i.a.createElement(f,{onSubmit:this.addPoint})),i.a.createElement(N,{items:this.state.points,moveItem:this.reorderPoints,removeItem:this.removePoint})),t=i.a.createElement("div",null,i.a.createElement(H,{warning:this.state.scriptError,center:this.state.currentCoord,points:this.state.points,handleMapChange:this.updateCurrentCoord,handlePointMove:this.movePoint,asyncScriptOnLoad:this.callAfterScriptLoads}),this.state.sidebarDocked?"":i.a.createElement(B,{handleClick:this.toggleSidebar}));return i.a.createElement("div",{className:"App"},i.a.createElement(R.a,{open:this.state.sidebarOpen,docked:this.state.sidebarDocked,sidebarClassName:"app__sidebar",onSetOpen:this.toggleSidebar,sidebar:e,children:t}))}},{key:"callAfterScriptLoads",value:function(e){this.setState(b()(this.state,{scriptError:{$set:e.errored}}))}},{key:"toggleSidebar",value:function(){this.setState(b()(this.state,{sidebarOpen:{$set:!this.state.sidebarOpen}}))}},{key:"handleMediaQueryChanged",value:function(){this.setState(b()(this.state,{sidebarDocked:{$set:T.matches},sidebarOpen:{$set:!1}}))}},{key:"updateCurrentCoord",value:function(e){this.setState(b()(this.state,{currentCoord:{$set:e}}))}},{key:"addPoint",value:function(e){this.setState(b()(this.state,{points:{$push:[{id:this.state.currentId,name:e,coord:this.state.currentCoord}]},currentId:{$set:this.state.currentId+1}}))}},{key:"removePoint",value:function(e){this.setState(b()(this.state,{points:{$splice:[[e,1]]}}))}},{key:"reorderPoints",value:function(e,t){this.setState(b()(this.state,{points:{$splice:[[e,1],[t,0,this.state.points[e]]]}}))}},{key:"movePoint",value:function(e,t){this.setState(b()(this.state,{points:Object(s.a)({},e,{coord:{$set:t}})}))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(i.a.createElement(Q,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},82:function(e,t,n){e.exports=n(240)},87:function(e,t,n){},89:function(e,t,n){},91:function(e,t,n){},93:function(e,t,n){}},[[82,2,1]]]);
//# sourceMappingURL=main.3e84fe27.chunk.js.map